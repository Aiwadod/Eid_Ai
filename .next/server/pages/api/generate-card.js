"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/generate-card";
exports.ids = ["pages/api/generate-card"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-card&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fgenerate-card.ts&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-card&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fgenerate-card.ts&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_generate_card_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/pages/api/generate-card.ts */ \"(api-node)/./src/pages/api/generate-card.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_generate_card_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_generate_card_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/generate-card\",\n        pathname: \"/api/generate-card\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_generate_card_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGZ2VuZXJhdGUtY2FyZCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnNyYyUyRnBhZ2VzJTJGYXBpJTJGZ2VuZXJhdGUtY2FyZC50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDRTtBQUMxRDtBQUM2RDtBQUM3RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsNERBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLDREQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLHlHQUFtQjtBQUNsRDtBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vc3JjL3BhZ2VzL2FwaS9nZW5lcmF0ZS1jYXJkLnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9nZW5lcmF0ZS1jYXJkXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZ2VuZXJhdGUtY2FyZFwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-card&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fgenerate-card.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./src/pages/api/generate-card.ts":
/*!****************************************!*\
  !*** ./src/pages/api/generate-card.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sharp */ \"sharp\");\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(sharp__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nasync function handler(req, res) {\n    if (req.method !== 'POST') {\n        return res.status(405).json({\n            message: 'Method Not Allowed'\n        });\n    }\n    const { userName, isClubMember } = req.body;\n    if (!userName || typeof isClubMember === 'undefined') {\n        return res.status(400).json({\n            message: 'Missing parameters'\n        });\n    }\n    try {\n        const imageDir = isClubMember ? 'ai' : 'others';\n        const directoryPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), 'public', imageDir);\n        // Get list of image files in the directory\n        const files = await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().readdir(directoryPath);\n        const imageFiles = files.filter((file)=>{\n            const lowerCaseFile = file.toLowerCase();\n            return lowerCaseFile.endsWith('.jpg') || lowerCaseFile.endsWith('.jpeg') || lowerCaseFile.endsWith('.png');\n        });\n        if (imageFiles.length === 0) {\n            return res.status(404).json({\n                message: `No image files found in ${imageDir} directory.`\n            });\n        }\n        // Select a random image file\n        const randomImageName = imageFiles[Math.floor(Math.random() * imageFiles.length)];\n        const imagePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(directoryPath, randomImageName);\n        // Check if the image file exists (redundant after readdir but good practice)\n        try {\n            await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().access(imagePath);\n        } catch (error) {\n            console.error(`Image file not found: ${imagePath}`, error);\n            return res.status(404).json({\n                message: 'Selected background image not found.'\n            });\n        }\n        let image = sharp__WEBPACK_IMPORTED_MODULE_0___default()(imagePath);\n        const metadata = await image.metadata();\n        // Calculate text position (closer to the top for header)\n        const textYPercentage = 15; // Position at 15% of the height from the top\n        const textY = metadata.height * textYPercentage / 100;\n        // SVG for text overlay\n        const svgText = `\n      <svg width=\"${metadata.width}\" height=\"${metadata.height}\">\n        <style>\n          .title { fill: #ffffff; font-size: 60px; font-weight: bold; text-anchor: middle; font-family: 'Noto Sans Arabic', sans-serif; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); }\n        </style>\n        <text x=\"50%\" y=\"${textY}\" class=\"title\">${userName}</text>\n      </svg>\n    `;\n        const svgBuffer = Buffer.from(svgText);\n        const compositeLayers = [\n            {\n                input: svgBuffer,\n                gravity: 'northwest',\n                top: 0,\n                left: 0\n            }\n        ];\n        // Add logo if the user is a club member\n        if (isClubMember) {\n            const logoPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), 'public', 'logo.png');\n            try {\n                await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().access(logoPath);\n                const logoBuffer = await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().readFile(logoPath);\n                // Resize logo if needed and calculate position\n                const logo = sharp__WEBPACK_IMPORTED_MODULE_0___default()(logoBuffer).resize({\n                    width: 100\n                }); // Adjust size as needed\n                const logoMetadata = await logo.metadata();\n                const logoX = (metadata.width - logoMetadata.width) / 2; // Center horizontally\n                const logoY = 20; // Position 20px from the top (adjust as needed)\n                compositeLayers.push({\n                    input: await logo.toBuffer(),\n                    top: logoY,\n                    left: logoX\n                });\n            } catch (logoError) {\n                console.error('Logo file not found or error processing logo:', logoError);\n            // Optionally, you can still proceed without the logo or send an error\n            }\n        }\n        const finalImageBuffer = await image.composite(compositeLayers).png().toBuffer();\n        res.setHeader('Content-Type', 'image/png');\n        res.status(200).send(finalImageBuffer);\n    } catch (error) {\n        console.error('Error generating card:', error);\n        res.status(500).json({\n            message: 'Error generating card'\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9wYWdlcy9hcGkvZ2VuZXJhdGUtY2FyZC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQzBCO0FBQ0Y7QUFDSztBQUVkLGVBQWVHLFFBQzVCQyxHQUFtQixFQUNuQkMsR0FBb0I7SUFFcEIsSUFBSUQsSUFBSUUsTUFBTSxLQUFLLFFBQVE7UUFDekIsT0FBT0QsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxTQUFTO1FBQXFCO0lBQzlEO0lBRUEsTUFBTSxFQUFFQyxRQUFRLEVBQUVDLFlBQVksRUFBRSxHQUFHUCxJQUFJUSxJQUFJO0lBRTNDLElBQUksQ0FBQ0YsWUFBWSxPQUFPQyxpQkFBaUIsYUFBYTtRQUNwRCxPQUFPTixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLFNBQVM7UUFBcUI7SUFDOUQ7SUFFQSxJQUFJO1FBQ0YsTUFBTUksV0FBV0YsZUFBZSxPQUFPO1FBQ3ZDLE1BQU1HLGdCQUFnQmIsZ0RBQVMsQ0FBQ2UsUUFBUUMsR0FBRyxJQUFJLFVBQVVKO1FBRXpELDJDQUEyQztRQUMzQyxNQUFNSyxRQUFRLE1BQU1oQiwwREFBVSxDQUFDWTtRQUMvQixNQUFNTSxhQUFhRixNQUFNRyxNQUFNLENBQUNDLENBQUFBO1lBQzlCLE1BQU1DLGdCQUFnQkQsS0FBS0UsV0FBVztZQUN0QyxPQUFPRCxjQUFjRSxRQUFRLENBQUMsV0FBV0YsY0FBY0UsUUFBUSxDQUFDLFlBQVlGLGNBQWNFLFFBQVEsQ0FBQztRQUNyRztRQUVBLElBQUlMLFdBQVdNLE1BQU0sS0FBSyxHQUFHO1lBQzNCLE9BQU9yQixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxTQUFTLENBQUMsd0JBQXdCLEVBQUVJLFNBQVMsV0FBVyxDQUFDO1lBQUM7UUFDMUY7UUFFQSw2QkFBNkI7UUFDN0IsTUFBTWMsa0JBQWtCUCxVQUFVLENBQUNRLEtBQUtDLEtBQUssQ0FBQ0QsS0FBS0UsTUFBTSxLQUFLVixXQUFXTSxNQUFNLEVBQUU7UUFDakYsTUFBTUssWUFBWTlCLGdEQUFTLENBQUNhLGVBQWVhO1FBRTNDLDZFQUE2RTtRQUM3RSxJQUFJO1lBQ0YsTUFBTXpCLHlEQUFTLENBQUM2QjtRQUNsQixFQUFFLE9BQU9FLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLENBQUMsc0JBQXNCLEVBQUVGLFdBQVcsRUFBRUU7WUFDcEQsT0FBTzVCLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLFNBQVM7WUFBdUM7UUFDaEY7UUFFQSxJQUFJMEIsUUFBUW5DLDRDQUFLQSxDQUFDK0I7UUFDbEIsTUFBTUssV0FBVyxNQUFNRCxNQUFNQyxRQUFRO1FBRXJDLHlEQUF5RDtRQUN6RCxNQUFNQyxrQkFBa0IsSUFBSSw2Q0FBNkM7UUFDekUsTUFBTUMsUUFBUSxTQUFVQyxNQUFNLEdBQUdGLGtCQUFtQjtRQUVwRCx1QkFBdUI7UUFDdkIsTUFBTUcsVUFBVSxDQUFDO2tCQUNILEVBQUVKLFNBQVNLLEtBQUssQ0FBQyxVQUFVLEVBQUVMLFNBQVNHLE1BQU0sQ0FBQzs7Ozt5QkFJdEMsRUFBRUQsTUFBTSxnQkFBZ0IsRUFBRTVCLFNBQVM7O0lBRXhELENBQUM7UUFFRCxNQUFNZ0MsWUFBWUMsT0FBT0MsSUFBSSxDQUFDSjtRQUU5QixNQUFNSyxrQkFBeUI7WUFDN0I7Z0JBQUVDLE9BQU9KO2dCQUFXSyxTQUFTO2dCQUFhQyxLQUFLO2dCQUFHQyxNQUFNO1lBQUU7U0FDM0Q7UUFFRCx3Q0FBd0M7UUFDeEMsSUFBSXRDLGNBQWM7WUFDaEIsTUFBTXVDLFdBQVdqRCxnREFBUyxDQUFDZSxRQUFRQyxHQUFHLElBQUksVUFBVTtZQUNwRCxJQUFJO2dCQUNGLE1BQU1mLHlEQUFTLENBQUNnRDtnQkFDaEIsTUFBTUMsYUFBYSxNQUFNakQsMkRBQVcsQ0FBQ2dEO2dCQUVyQywrQ0FBK0M7Z0JBQy9DLE1BQU1HLE9BQU9yRCw0Q0FBS0EsQ0FBQ21ELFlBQVlHLE1BQU0sQ0FBQztvQkFBRWIsT0FBTztnQkFBSSxJQUFJLHdCQUF3QjtnQkFDL0UsTUFBTWMsZUFBZSxNQUFNRixLQUFLakIsUUFBUTtnQkFFeEMsTUFBTW9CLFFBQVEsQ0FBQ3BCLFNBQVNLLEtBQUssR0FBR2MsYUFBYWQsS0FBSyxJQUFJLEdBQUcsc0JBQXNCO2dCQUMvRSxNQUFNZ0IsUUFBUSxJQUFJLGdEQUFnRDtnQkFFbEVaLGdCQUFnQmEsSUFBSSxDQUFDO29CQUNuQlosT0FBTyxNQUFNTyxLQUFLTSxRQUFRO29CQUMxQlgsS0FBS1M7b0JBQ0xSLE1BQU1PO2dCQUNSO1lBRUYsRUFBRSxPQUFPSSxXQUFXO2dCQUNsQjFCLFFBQVFELEtBQUssQ0FBQyxpREFBaUQyQjtZQUMvRCxzRUFBc0U7WUFDeEU7UUFDRjtRQUVBLE1BQU1DLG1CQUFtQixNQUFNMUIsTUFDNUIyQixTQUFTLENBQUNqQixpQkFDVmtCLEdBQUcsR0FDSEosUUFBUTtRQUVYdEQsSUFBSTJELFNBQVMsQ0FBQyxnQkFBZ0I7UUFDOUIzRCxJQUFJRSxNQUFNLENBQUMsS0FBSzBELElBQUksQ0FBQ0o7SUFFdkIsRUFBRSxPQUFPNUIsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QzVCLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsU0FBUztRQUF3QjtJQUMxRDtBQUNGIiwic291cmNlcyI6WyIvaG9tZS9jYW5kaS9Eb3dubG9hZHMvRWlkX0FpL3NyYy9wYWdlcy9hcGkvZ2VuZXJhdGUtY2FyZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCBzaGFycCBmcm9tICdzaGFycCc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBmcyBmcm9tICdmcy9wcm9taXNlcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIoXG4gIHJlcTogTmV4dEFwaVJlcXVlc3QsXG4gIHJlczogTmV4dEFwaVJlc3BvbnNlXG4pIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IG1lc3NhZ2U6ICdNZXRob2QgTm90IEFsbG93ZWQnIH0pO1xuICB9XG5cbiAgY29uc3QgeyB1c2VyTmFtZSwgaXNDbHViTWVtYmVyIH0gPSByZXEuYm9keTtcblxuICBpZiAoIXVzZXJOYW1lIHx8IHR5cGVvZiBpc0NsdWJNZW1iZXIgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogJ01pc3NpbmcgcGFyYW1ldGVycycgfSk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IGltYWdlRGlyID0gaXNDbHViTWVtYmVyID8gJ2FpJyA6ICdvdGhlcnMnO1xuICAgIGNvbnN0IGRpcmVjdG9yeVBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3B1YmxpYycsIGltYWdlRGlyKTtcblxuICAgIC8vIEdldCBsaXN0IG9mIGltYWdlIGZpbGVzIGluIHRoZSBkaXJlY3RvcnlcbiAgICBjb25zdCBmaWxlcyA9IGF3YWl0IGZzLnJlYWRkaXIoZGlyZWN0b3J5UGF0aCk7XG4gICAgY29uc3QgaW1hZ2VGaWxlcyA9IGZpbGVzLmZpbHRlcihmaWxlID0+IHtcbiAgICAgIGNvbnN0IGxvd2VyQ2FzZUZpbGUgPSBmaWxlLnRvTG93ZXJDYXNlKCk7XG4gICAgICByZXR1cm4gbG93ZXJDYXNlRmlsZS5lbmRzV2l0aCgnLmpwZycpIHx8IGxvd2VyQ2FzZUZpbGUuZW5kc1dpdGgoJy5qcGVnJykgfHwgbG93ZXJDYXNlRmlsZS5lbmRzV2l0aCgnLnBuZycpO1xuICAgIH0pO1xuXG4gICAgaWYgKGltYWdlRmlsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiBgTm8gaW1hZ2UgZmlsZXMgZm91bmQgaW4gJHtpbWFnZURpcn0gZGlyZWN0b3J5LmAgfSk7XG4gICAgfVxuXG4gICAgLy8gU2VsZWN0IGEgcmFuZG9tIGltYWdlIGZpbGVcbiAgICBjb25zdCByYW5kb21JbWFnZU5hbWUgPSBpbWFnZUZpbGVzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGltYWdlRmlsZXMubGVuZ3RoKV07XG4gICAgY29uc3QgaW1hZ2VQYXRoID0gcGF0aC5qb2luKGRpcmVjdG9yeVBhdGgsIHJhbmRvbUltYWdlTmFtZSk7XG5cbiAgICAvLyBDaGVjayBpZiB0aGUgaW1hZ2UgZmlsZSBleGlzdHMgKHJlZHVuZGFudCBhZnRlciByZWFkZGlyIGJ1dCBnb29kIHByYWN0aWNlKVxuICAgIHRyeSB7XG4gICAgICBhd2FpdCBmcy5hY2Nlc3MoaW1hZ2VQYXRoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihgSW1hZ2UgZmlsZSBub3QgZm91bmQ6ICR7aW1hZ2VQYXRofWAsIGVycm9yKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IG1lc3NhZ2U6ICdTZWxlY3RlZCBiYWNrZ3JvdW5kIGltYWdlIG5vdCBmb3VuZC4nIH0pO1xuICAgIH1cblxuICAgIGxldCBpbWFnZSA9IHNoYXJwKGltYWdlUGF0aCk7XG4gICAgY29uc3QgbWV0YWRhdGEgPSBhd2FpdCBpbWFnZS5tZXRhZGF0YSgpO1xuXG4gICAgLy8gQ2FsY3VsYXRlIHRleHQgcG9zaXRpb24gKGNsb3NlciB0byB0aGUgdG9wIGZvciBoZWFkZXIpXG4gICAgY29uc3QgdGV4dFlQZXJjZW50YWdlID0gMTU7IC8vIFBvc2l0aW9uIGF0IDE1JSBvZiB0aGUgaGVpZ2h0IGZyb20gdGhlIHRvcFxuICAgIGNvbnN0IHRleHRZID0gKG1ldGFkYXRhLmhlaWdodCAqIHRleHRZUGVyY2VudGFnZSkgLyAxMDA7XG5cbiAgICAvLyBTVkcgZm9yIHRleHQgb3ZlcmxheVxuICAgIGNvbnN0IHN2Z1RleHQgPSBgXG4gICAgICA8c3ZnIHdpZHRoPVwiJHttZXRhZGF0YS53aWR0aH1cIiBoZWlnaHQ9XCIke21ldGFkYXRhLmhlaWdodH1cIj5cbiAgICAgICAgPHN0eWxlPlxuICAgICAgICAgIC50aXRsZSB7IGZpbGw6ICNmZmZmZmY7IGZvbnQtc2l6ZTogNjBweDsgZm9udC13ZWlnaHQ6IGJvbGQ7IHRleHQtYW5jaG9yOiBtaWRkbGU7IGZvbnQtZmFtaWx5OiAnTm90byBTYW5zIEFyYWJpYycsIHNhbnMtc2VyaWY7IHRleHQtc2hhZG93OiAycHggMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuNSk7IH1cbiAgICAgICAgPC9zdHlsZT5cbiAgICAgICAgPHRleHQgeD1cIjUwJVwiIHk9XCIke3RleHRZfVwiIGNsYXNzPVwidGl0bGVcIj4ke3VzZXJOYW1lfTwvdGV4dD5cbiAgICAgIDwvc3ZnPlxuICAgIGA7XG5cbiAgICBjb25zdCBzdmdCdWZmZXIgPSBCdWZmZXIuZnJvbShzdmdUZXh0KTtcblxuICAgIGNvbnN0IGNvbXBvc2l0ZUxheWVyczogYW55W10gPSBbXG4gICAgICB7IGlucHV0OiBzdmdCdWZmZXIsIGdyYXZpdHk6ICdub3J0aHdlc3QnLCB0b3A6IDAsIGxlZnQ6IDAgfVxuICAgIF07XG5cbiAgICAvLyBBZGQgbG9nbyBpZiB0aGUgdXNlciBpcyBhIGNsdWIgbWVtYmVyXG4gICAgaWYgKGlzQ2x1Yk1lbWJlcikge1xuICAgICAgY29uc3QgbG9nb1BhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3B1YmxpYycsICdsb2dvLnBuZycpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgZnMuYWNjZXNzKGxvZ29QYXRoKTtcbiAgICAgICAgY29uc3QgbG9nb0J1ZmZlciA9IGF3YWl0IGZzLnJlYWRGaWxlKGxvZ29QYXRoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlc2l6ZSBsb2dvIGlmIG5lZWRlZCBhbmQgY2FsY3VsYXRlIHBvc2l0aW9uXG4gICAgICAgIGNvbnN0IGxvZ28gPSBzaGFycChsb2dvQnVmZmVyKS5yZXNpemUoeyB3aWR0aDogMTAwIH0pOyAvLyBBZGp1c3Qgc2l6ZSBhcyBuZWVkZWRcbiAgICAgICAgY29uc3QgbG9nb01ldGFkYXRhID0gYXdhaXQgbG9nby5tZXRhZGF0YSgpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbG9nb1ggPSAobWV0YWRhdGEud2lkdGggLSBsb2dvTWV0YWRhdGEud2lkdGgpIC8gMjsgLy8gQ2VudGVyIGhvcml6b250YWxseVxuICAgICAgICBjb25zdCBsb2dvWSA9IDIwOyAvLyBQb3NpdGlvbiAyMHB4IGZyb20gdGhlIHRvcCAoYWRqdXN0IGFzIG5lZWRlZClcblxuICAgICAgICBjb21wb3NpdGVMYXllcnMucHVzaCh7XG4gICAgICAgICAgaW5wdXQ6IGF3YWl0IGxvZ28udG9CdWZmZXIoKSxcbiAgICAgICAgICB0b3A6IGxvZ29ZLFxuICAgICAgICAgIGxlZnQ6IGxvZ29YLFxuICAgICAgICB9KTtcblxuICAgICAgfSBjYXRjaCAobG9nb0Vycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0xvZ28gZmlsZSBub3QgZm91bmQgb3IgZXJyb3IgcHJvY2Vzc2luZyBsb2dvOicsIGxvZ29FcnJvcik7XG4gICAgICAgIC8vIE9wdGlvbmFsbHksIHlvdSBjYW4gc3RpbGwgcHJvY2VlZCB3aXRob3V0IHRoZSBsb2dvIG9yIHNlbmQgYW4gZXJyb3JcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBmaW5hbEltYWdlQnVmZmVyID0gYXdhaXQgaW1hZ2VcbiAgICAgIC5jb21wb3NpdGUoY29tcG9zaXRlTGF5ZXJzKVxuICAgICAgLnBuZygpXG4gICAgICAudG9CdWZmZXIoKTtcblxuICAgIHJlcy5zZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdpbWFnZS9wbmcnKTtcbiAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChmaW5hbEltYWdlQnVmZmVyKTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgY2FyZDonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiAnRXJyb3IgZ2VuZXJhdGluZyBjYXJkJyB9KTtcbiAgfVxufSAiXSwibmFtZXMiOlsic2hhcnAiLCJwYXRoIiwiZnMiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJ1c2VyTmFtZSIsImlzQ2x1Yk1lbWJlciIsImJvZHkiLCJpbWFnZURpciIsImRpcmVjdG9yeVBhdGgiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImZpbGVzIiwicmVhZGRpciIsImltYWdlRmlsZXMiLCJmaWx0ZXIiLCJmaWxlIiwibG93ZXJDYXNlRmlsZSIsInRvTG93ZXJDYXNlIiwiZW5kc1dpdGgiLCJsZW5ndGgiLCJyYW5kb21JbWFnZU5hbWUiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJpbWFnZVBhdGgiLCJhY2Nlc3MiLCJlcnJvciIsImNvbnNvbGUiLCJpbWFnZSIsIm1ldGFkYXRhIiwidGV4dFlQZXJjZW50YWdlIiwidGV4dFkiLCJoZWlnaHQiLCJzdmdUZXh0Iiwid2lkdGgiLCJzdmdCdWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwiY29tcG9zaXRlTGF5ZXJzIiwiaW5wdXQiLCJncmF2aXR5IiwidG9wIiwibGVmdCIsImxvZ29QYXRoIiwibG9nb0J1ZmZlciIsInJlYWRGaWxlIiwibG9nbyIsInJlc2l6ZSIsImxvZ29NZXRhZGF0YSIsImxvZ29YIiwibG9nb1kiLCJwdXNoIiwidG9CdWZmZXIiLCJsb2dvRXJyb3IiLCJmaW5hbEltYWdlQnVmZmVyIiwiY29tcG9zaXRlIiwicG5nIiwic2V0SGVhZGVyIiwic2VuZCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./src/pages/api/generate-card.ts\n");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "sharp":
/*!************************!*\
  !*** external "sharp" ***!
  \************************/
/***/ ((module) => {

module.exports = require("sharp");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-card&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fgenerate-card.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();